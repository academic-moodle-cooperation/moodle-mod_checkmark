define(["jquery","core/log"],function(a,b){var c=function(){this.dividingSymbol=","};c.prototype.updateSettings=function(b){var c=0,d=0;b.data.stripper(b);var e="#id_grade_modgrade_type",f="#id_grade_modgrade_point",g="#id_flexiblenaming",h="#id_examplegrades",i="#id_examplenames",j="#id_examplecount";if("point"!=a(e).val())return!0;if(a(g).prop("checked")){var k=new RegExp(b.data.dividingSymbol+"{2,}","g");if(a(h).val(a(h).val().replace(k,b.data.dividingSymbol)),"valuechange"!=b.type){var l=new RegExp("^"+b.data.dividingSymbol+"*|"+b.data.dividingSymbol+"*$","g");a(h).val(a(h).val().replace(l,"")),a(i).val(a(i).val().replace(l,""))}var m=new RegExp("[^0-9"+b.data.dividingSymbol+"]"),n=a(h).val().replace(m,""),o=n.split(b.data.dividingSymbol);for(d=0;d<o.length;d++)""!==o[d].replace(/[^\d]/g,"")&&(c+=parseInt(o[d].replace(/[^\d]/g,"")))}else c=a(j).val();return!a(g).prop("checked")&&a(f).val()%c===0||(c<=100&&c>0?(a(e).val("point"),a(f).val(c)):c<0&&a(e).val("scale"),!0)},c.prototype.stripper=function(b){if(null!==b&&b.which<=46)return!0;var c="#examplegrades";a(c).length||(c="#id_examplegrades");var d=new RegExp("[^0-9"+b.data.dividingSymbol+"]","g");return a(c).val(a(c).val().replace(d,"")),!0};var d=new c;return d.initializer=function(c){d.dividingSymbol=c.dividingSymbol,b.info("Initialize settings JS","checkmark");var e="#id_grade_modgrade_type",f="#id_flexiblenaming",g="#id_examplegrades",h="#id_examplenames",i="#id_examplecount";a(f).click(d,d.updateSettings),a(e).change(d,d.updateSettings),a(g).change(d,d.updateSettings),a(h).change(d,d.updateSettings),a(i).change(d,d.updateSettings),a(g).blur(d,d.updateSettings),a(h).blur(d,d.updateSettings),a(i).blur(d,d.updateSettings),a(g).keyup(d,d.stripper),"no"===a("input[name=allready_submit]").val()&&d.updateSettings({data:d})},d});