/**
 * settings.js
 *
 * @module   mod_checkmark/checkboxcontroller
 * @author    Philipp Hager
 * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_checkmark/settings",["jquery","core/log"],(function($,log){var Settings=function(){this.dividingSymbol=","};Settings.prototype.updateSettings=function(e){var gradeSum=0,i=0;e.data.stripper(e);if("point"!==$("#id_grade_modgrade_type").val())return!0;if($("#id_flexiblenaming").prop("checked")){var regex1=new RegExp(e.data.dividingSymbol+"{2,}","g");if($("#id_examplegrades").val($("#id_examplegrades").val().replace(regex1,e.data.dividingSymbol)),"valuechange"!==e.type){var regex2=new RegExp("^"+e.data.dividingSymbol+"*|"+e.data.dividingSymbol+"*$","g");$("#id_examplegrades").val($("#id_examplegrades").val().replace(regex2,"")),$("#id_examplenames").val($("#id_examplenames").val().replace(regex2,""))}var regex3=new RegExp("[^0-9"+e.data.dividingSymbol+"]"),tempArray=$("#id_examplegrades").val().replace(regex3,"").split(e.data.dividingSymbol);for(i=0;i<tempArray.length;i++)""!==tempArray[i].replace(/[^\d]/g,"")&&(gradeSum+=parseInt(tempArray[i].replace(/[^\d]/g,"")))}else gradeSum=$("#id_examplecount").val();return!$("#id_flexiblenaming").prop("checked")&&$("#id_grade_modgrade_point").val()%gradeSum==0||(gradeSum<=100&&gradeSum>0?($("#id_grade_modgrade_type").val("point"),$("#id_grade_modgrade_point").val(gradeSum)):gradeSum<0&&$("#id_grade_modgrade_type").val("scale"),!0)},Settings.prototype.stripper=function(e){if(null!==e&&e.which<=46)return!0;var exampleGradesSelector="#examplegrades";$(exampleGradesSelector).length||(exampleGradesSelector="#id_examplegrades");var regex=new RegExp("[^0-9"+e.data.dividingSymbol+"]","g");return $(exampleGradesSelector).val($(exampleGradesSelector).val().replace(regex,"")),!0};var instance=new Settings;return instance.initializer=function(config){instance.dividingSymbol=config.dividingSymbol,log.info("Initialize settings JS","checkmark");return $("#id_flexiblenaming").click(instance,instance.updateSettings),$("#id_grade_modgrade_type").change(instance,instance.updateSettings),$("#id_examplegrades").change(instance,instance.updateSettings),$("#id_examplenames").change(instance,instance.updateSettings),$("#id_examplecount").change(instance,instance.updateSettings),$("#id_examplegrades").blur(instance,instance.updateSettings),$("#id_examplenames").blur(instance,instance.updateSettings),$("#id_examplecount").blur(instance,instance.updateSettings),$("#id_examplegrades").keyup(instance,instance.stripper),"no"===$("input[name=allready_submit]").val()&&instance.updateSettings({data:instance}),!0},instance}));

//# sourceMappingURL=settings.min.js.map