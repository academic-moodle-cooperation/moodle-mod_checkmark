{"version":3,"file":"submission.min.js","sources":["../src/submission.js"],"sourcesContent":["// This file is part of mod_checkmark for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * submission.js\n *\n * @module   mod_checkmark/checkboxcontroller\n * @author    Philipp Hager\n * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n /**\n  * @module mod_checkmark/submission\n  */\ndefine(['core/log', 'jquery'], function(log, $) {\n\n    /**\n     * @constructor\n     * @alias module:mod_checkmark/submission\n     */\n    let Submission = function() {\n    };\n\n    /**\n     * UpdateSummary updates the displayed summary during submission edit\n     *\n     * @return {boolean} true if everything's alright (no error handling by now)\n     */\n    Submission.prototype.updateSummary = function() {\n        let examplesNew = 0;\n        let gradeNew = 0;\n\n        $('input[data-example]').each(function() {\n            if (this.checked) {\n                examplesNew++;\n                gradeNew += parseInt(this.dataset.grade);\n            }\n        });\n\n        $('#examples').html(examplesNew.toString());\n        $('#grade').html(gradeNew.toString());\n        return true;\n    };\n\n    /**\n     * ResetSubmissionForm reset method replaces std-reset-behaviour\n     *   I) prevents default reset behaviour\n     *  II) resets the form manually\n     * III) ensure to display updated data\n     * @param {Event} event event-object\n     * @return {boolean} true if everything's allright (no error handling by now)\n     */\n    Submission.prototype.resetSubmissionForm = function(event) {\n        event.preventDefault();\n        $('.submissionform')[0].reset();\n        Submission.prototype.updateSummary();\n        return true;\n    };\n\n    let instance = new Submission();\n\n    /**\n     * Initializer prepares checkmark-data and registers event-listeners for each checkbox\n     *\n     * @return {boolean} true if everything's ok (no error-handling implemented)\n     */\n    instance.initializer = function() {\n        // Only execute init if checkmarkform is actually present.\n        if ($('#checkmarkform').length) {\n            log.debug('Init checkmark submissions js!', 'checkmark');\n            // Register event-listener on checkboxes to ensure update of the check counter.\n            $('input[data-example]').on('click', instance.updateSummary);\n            // Register event-listener on reset-button to ensure proper data to be displayed on form-reset!\n            $('#id_resetbutton').on('click', this.resetSubmissionForm);\n\n            // Reset the formular after init to ensure correct checkbox-states after page-reload!\n            const form = $('.submissionform')[0];\n            if (form) {\n                form.reset();\n            }\n            // Update summary to display correct data after form-reset!\n            this.updateSummary();\n        }\n        return true;\n    };\n\n    return instance;\n});\n"],"names":["define","log","$","Submission","prototype","updateSummary","examplesNew","gradeNew","each","this","checked","parseInt","dataset","grade","html","toString","resetSubmissionForm","event","preventDefault","reset","instance","initializer","length","debug","on","form"],"mappings":";;;;;;;;AA2BAA,OAAM,2BAAC,CAAC,WAAY,WAAW,SAASC,IAAKC,GAMzC,IAAIC,WAAa,aAQjBA,WAAWC,UAAUC,cAAgB,WAC7BC,IAAAA,YAAc,EACdC,SAAW,EAWf,OATAL,EAAE,uBAAuBM,MAAK,WACtBC,KAAKC,UACLJ,cACAC,UAAYI,SAASF,KAAKG,QAAQC,WAI1CX,EAAE,aAAaY,KAAKR,YAAYS,YAChCb,EAAE,UAAUY,KAAKP,SAASQ,aACnB,GAWXZ,WAAWC,UAAUY,oBAAsB,SAASC,OAIhD,OAHAA,MAAMC,iBACNhB,EAAE,mBAAmB,GAAGiB,QACxBhB,WAAWC,UAAUC,iBACd,GAGX,IAAIe,SAAW,IAAIjB,WA2BnB,OApBAiB,SAASC,YAAc,WAEnB,GAAInB,EAAE,kBAAkBoB,OAAQ,CAC5BrB,IAAIsB,MAAM,iCAAkC,aAE5CrB,EAAE,uBAAuBsB,GAAG,QAASJ,SAASf,eAE9CH,EAAE,mBAAmBsB,GAAG,QAASf,KAAKO,qBAGhCS,MAAAA,KAAOvB,EAAE,mBAAmB,GAC9BuB,MACAA,KAAKN,QAGTV,KAAKJ,gBAET,OAAO,GAGJe"}